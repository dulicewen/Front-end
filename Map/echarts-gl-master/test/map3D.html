<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Map3D - ECHARTS-GL</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes"> <!-- Fullscreen Landscape on iOS -->
        <link rel="stylesheet" href="./common.css">
    </head>
    <body>
        <div id="main"></div>
       <script src="lib/echarts.js"></script>
        <script src="map/guizhou.js"></script>
        <script src="../dist/echarts-gl.min.js"></script>
        <script src="lib/jquery.min.js"></script>
        <script>

            var geoCoordMap = {
    "贵阳市":[106.6992,26.7682],
    "安顺市":[105.9082,25.9882],
    "六盘水市":[104.7546,26.0925],
    "黔西南布依族苗族自治州":[105.5347,25.3949],
    "铜仁地区":[108.6218,28.0096],
    "黔南布依族苗族自治州":[107.2485,25.8398],
    "毕节地区":[105.1611,27.0648],
    "黔东南苗族侗族自治州":[108.4241,26.4166],
    "遵义市":[106.908,28.1744]

};

var City_data=[
    //{name: "贵阳市",value:50},
    {name: "贵阳市"},
    {name: "安顺市"},
    {name: "六盘水市"},
    {name: "遵义市"},
    {name: "毕节地区"},
    {name:'黔西南布依族苗族自治州'},
    {name:'黔南布依族苗族自治州'},
    {name:'铜仁地区'},
    {name:'黔东南苗族侗族自治州'}
] 
var convertData = function (data) {
       
    var res = [];
    for (var i = 0; i < data.length; i++) {
        var geoCoord = geoCoordMap[data[i].name];
        if (geoCoord) {
            res.push({
                name: data[i].name,
                //value: geoCoord.concat(data[i].value)
                 value:data[i].value?geoCoord.concat(data[i].value):geoCoord.concat(randomData())
            });
        }
    }
    //console.log(res);
    return res;
    };
    var chart = echarts.init(document.getElementById('main'));
            
            $.getJSON('data/alcohol.json', function (data) {

                var regionData = data.map(function (item) {
                    return {
                        name: item[0],
                        value: item[1] 
                    }
                })

                chart.setOption({
                     
                    visualMap: {
                        min: 0,
                        max: 15,
                        //realtime: true,
                        calculable : true,
                        inRange: {
                            color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                        }
                    },
                    series: [{
                        type: 'map3D',
                        map: '贵州',
                          shading: 'lambert',
                        // realisticMaterial: {
                        //     roughness: 0.2,
                        //     metalness: 0
                        // },
                        postEffect: {
                            enable: true,
                            SSAO: {
                                enable: true,
                                radius: 2,
                                intensity: 1
                            }
                        },
                        // groundPlane: {
                        //     show: true
                        // },
                        // light: {
                        //     main: {
                        //         intensity: 2,
                        //         shadow: true,
                        //         shadowQuality: 'high',
                        //         alpha: 30
                        //     },
                        //     ambient: {
                        //         intensity: 0
                        //     },
                        //     ambientCubemap: {
                        //         texture: 'asset/canyon.hdr',
                        //         exposure: 2,
                        //         diffuseIntensity: 1
                        //     }
                        // },
                        // viewControl: {
                        //     distance: 100,
                        //     panMouseButton: 'left',
                        //     rotateMouseButton: 'right'
                        // },

                        itemStyle: {
                            areaColor: '#eee',
                             borderColor: '#222',
                             borderWidth: 1
                        },

                        label: {
                              //backgroundColor: '#fff', 
                            //show: true,                             
                            textStyle: {
                                color: '#ff0',
                                borderColor: '#000'
                            }

                        },
                        emphasis:{
                            label: {
                                show: true,
                                distance: 2, 
                                textStyle: { 
                                color: '#000',
                                borderWidth: 2,
                                borderColor: '#fff',
                                fontFamily: 'sans-serif',
                                fontSize: 20,
                                fontWeight: 'normal'
                                }
                            }

                        },

                         regionHeight: 2,

                        data: regionData
                    }]
                });

            });
            window.addEventListener('resize', function () {
                chart.resize();
            });

        </script>
    </body>
</html>